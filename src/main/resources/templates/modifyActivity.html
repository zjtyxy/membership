<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>活动页面</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
    <link rel="stylesheet" href="assets/materialize/css/materialize.min.css" media="screen,projection"/>
    <!-- Bootstrap Styles-->
    <link href="assets/css/bootstrap.css" rel="stylesheet"/>
    <!-- FontAwesome Styles-->
    <link href="assets/css/font-awesome.css" rel="stylesheet"/>
    <!-- Morris Chart Styles-->
    <link href="assets/js/morris/morris-0.4.3.min.css" rel="stylesheet"/>
    <!-- Custom Styles-->
    <link href="assets/css/custom-styles.css" rel="stylesheet"/>

</head>

<body>

<div id="wrapper">
    <div th:replace="title :: html"></div>
    <!--侧边栏-->
    <div th:replace="sidebar :: html"></div>
    <!--内容主体-->
    <div id="page-wrapper">
        <!--内容主题-->
        <div class="header">
            <h1 class="page-header">
                活动页面
            </h1>
        </div>
        <div id="page-inner">
            <!--自定义内容-->
            <!--<div class="container">-->
            <div class="card">
                <div class="card-content">
                    <form th:action="@{/modifyActivity}" method="post" id="modifyActivity" th:object="${entity}"  >
                        <input id="idx" name="id" type="hidden" class="validate" th:value="*{getId()}" required/>
                        <div class="row">
                            <div class="form-group" style="width: 48%;float: left;padding-left: 20px">
                                <label for="name">活动名称</label>
                                <input id="name" name="name" type="text" class="validate" placeholder="活动名称"  th:value="*{getName()}" required/>
                            </div>
                            <div class="form-group" style="width: 48%;float: left;padding-left: 20px">
                                <label for="link">主页图片地址</label>
                                <input id="link" name="link" type="text" class="validate"
                                       placeholder="主页图片地址" th:value="*{getLink()}" required/>
                            </div>
                        </div>




                        <div class="row">
                            <div class="form-group" style="width: 48%;float: left;padding-left: 20px">
                                <label for="userName">发布者</label>
                                <input id="userName" name="userName" type="text" class="validate" th:field="*{userName}"
                                       placeholder="发布者" required/>
                            </div>
                            <div class="form-group" style="width: 48%;float: left;padding-left: 20px">
                                <label for="userDate">发布时间</label>
                                <input placeholder="发布时间" id="userDate" type="text" class="validate"
                                       name="userDate" th:value="*{getUserDate()}" required/>
                            </div>
                        </div>
                        <div>
                            <div class="row">
                                <div class="form-group"  style="width: 100%;float: left;padding-left: 20px">
                                    <label >活动日程</label>
                                    <button type="button" onclick="showDayTrip(true)" data-toggle="modal" data-target="#tripModal">添加日程
                                    </button>
                                </div>
                            </div>
                            <div class="row" id="daytrip">
                                <div class="form-group"  style="width: 48%;float: left;padding-left: 20px"   th:each="stat:*{getRoutingday()}">
                                    <label placeholder="日程"    type="text" th:text="'第'+${stat.key}+'天'"/>
                                    <input placeholder="简介"   class="validate" th:field="*{routingday[__${stat.key}__].title}" />
                                </div>
                            </div>

                        </div>
                        <div>
                            <div class="row">
                                <div class="form-group"  style="width: 100%;float: left;padding-left: 20px">
                                    <label >增值项目</label>
                                    <button type="button" data-toggle="modal" data-target="#myModal">添加项目
                                    </button>
                                </div>
                            </div>
                            <div class="row" id="project">
                                <div class="form-group"  style="width: 48%;float: left;padding-left: 20px"   th:each="stat:*{getIncrement()}">
                                    <label placeholder="项目名称"   id="increment.key" type="text" th:text="${stat.key}"/>
                                    <input placeholder="项目描述"   class="validate" th:field="*{increment[__${stat.key}__]}" />
                                </div>

                            </div>

                        </div>
                        <div>
                            <div class="row">
                                <div class="form-group"  style="width: 100%;float: left;padding-left: 20px">
                                <label >活动图片列表</label>
                                <button onclick="addImageUrl()"type="button">添加图片
                                </button>
                                </div>
                            </div>
                        <div class="row" id="imgurllist">
                            <div class="form-group"  style="width: 48%;float: left;padding-left: 20px"   th:each="stat:*{getImageurls()}">
                                <input placeholder="活动图片" id="imageurls" type="text" class="validate" name="imageurls" th:value="${stat}" required/>
                            </div>

                        </div>

                        </div>

                       <div class="row">

                           <button onclick="submitForm()" class="waves-effect waves-light btn" type="button" >确认修改</button>
                       </div>
                    </form>

                    <div class="clearBoth"></div>
                </div>
                <!--</div>-->
            </div>
            <!--页脚-->
            <br>
            <br>
            <br>
            <div th:replace="footer :: html"></div>
        </div>

    </div>
</div>
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h5 class="modal-title" id="myModalLabel">添加增值服务</h5>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="serverName">服务名称</label>
                    <input type="text" class="form-control" id="serverName" placeholder="服务名称">
                </div>
                <div class="form-group">
                    <label for="serverDesc">服务介绍</label>
                    <input type="text" class="form-control" id="serverDesc" placeholder="服务介绍">
                </div>


            </div>
            <div class="modal-footer">
                <button type="button" class="btn waves-effect waves-light" onclick="addServer()" data-dismiss="modal">保存修改</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="tripModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h5 class="modal-title">添加<span id="currentDay"></span>活动日程</h5>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="serverName">日程标题</label>
                    <input type="text" class="form-control" id="tripTitle" placeholder="日程标题">
                </div>
                <div>
                    <div class="row">
                        <div class="form-group"  style="width: 100%;float: left;padding-left: 20px">
                            <label >日程内容</label>
                            <button type="button" onclick="addContent()">添加
                            </button>
                        </div>
                    </div>
                    <div class="row" id="daytripcontent">

                    </div>

                </div>
            </div>
            <div class="modal-footer">
                    <button type="button" class="btn waves-effect waves-light" onclick="addDayTrip()" data-dismiss="modal">保存修改</button>
            </div>
        </div>
    </div>
</div>
<!-- JS Scripts-->
<!-- jQuery Js -->
<script src="assets/js/jquery-1.10.2.js"></script>

<!-- Bootstrap Js -->
<script src="assets/js/bootstrap.min.js"></script>

<script src="assets/materialize/js/materialize.min.js"></script>

<!-- Metis Menu Js -->
<script src="assets/js/jquery.metisMenu.js"></script>

<script src="assets/js/easypiechart.js"></script>
<script src="assets/js/easypiechart-data.js"></script>

<script src="assets/js/Lightweight-Chart/jquery.chart.js"></script>

<!-- Custom Js -->
<script src="assets/js/custom-scripts.js"></script>

<script  th:inline="javascript">
    function submitForm() {
        $('#modifyActivity').submit();
    }
    function addImageUrl() {
        let htmlstr = '<div class="form-group" style="width: 48%;float: left;padding-left: 20px">\n' +
            '            <input placeholder="活动图片" id="imageurls" type="text" class="validate" name="imageurls" />\n' +
            '            </div>'
        var htmllet = '<p>' + 'sdfasdf' + '</p>'
        $('#imgurllist').append(htmlstr);
    }

    function addContent() {
        var cindex  = tripdaycontent[tripday]++;
        var htmlstr = '<div class="form-group" style="width: 48%;float: left;padding-left: 20px">\n' +
            '            <input placeholder="标题" id="contentTitle'+(cindex)+'" type="text" class="validate"  />\n' +
            '            <input placeholder="内容" id="contentDesc'+(cindex)+'" type="text" class="validate" />\n' +
            '            </div>'
        $('#daytripcontent').append(htmlstr);
    }
    function addServer() {
        var name = $('#serverName').val();
        var desc = $('#serverDesc').val();
         var  htmlstr = '<div class="form-group" style="width: 48%;float: left;padding-left: 20px">\n' +
            '            <label placeholder="项目名称" id="increment.key" type="text">'+name+'</label>\n' +
           '            <input placeholder="项目介绍" id="increment" type="text" class="validate" name="increment['+name
             +']" value="'+desc+'"/>\n' +
            '            </div>'
        $('#project').append(htmlstr);
    }
    var tripday =[[${entity.getRoutingday().size()}]];
    var tripdaycontent={};
    function showDayTrip(isnew) {
        tripday++;
        $('#currentDay').html("第"+(tripday)+"天");
        var  asdfa =[[${entity.routingday}]]
        //
        if(isnew)
        tripdaycontent[tripday]=0;
        else
            tripdaycontent[tripday]=Object.keys(asdfa[tripday].content).length
        alert(tripday)

    }
    function addDayTrip() {
        var name = $('#tripTitle').val();
        var  htmlstr = '<div class="form-group" style="width: 48%;float: left;padding-left: 20px">\n' +
            ' <label type="text">第'+tripday+'天</label>'+
            '            <input placeholder="项目介绍" id="increment" type="text" class="validate" name="routingday['+tripday
            +'].title" value="'+name+'"/>\n' ;
        for(var i=0;i<tripdaycontent[tripday];i++)
        {
            htmlstr += '<input  id="increment" type="text" class="validate" name="routingday['+tripday
            +'].content['+$('#contentTitle'+i).val()+']" value="'+$('#contentDesc'+i).val()+'"/>\n' ;
        }

     htmlstr += ' </div>'
        $('#daytrip').append(htmlstr);
    }

</script>
</body>

</html>